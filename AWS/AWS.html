<!DOCTYPE html>
<html lang="en">
<head>
<!-- May 10, 2021 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AWS Notes</title>
<meta name="generator" content="Org mode">
<meta name="author" content="DESKTOP-TTOPQ58">
<link rel='icon' type='image/x-icon' href='/images/favicon.ico'/>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<link rel='stylesheet' href='https://code.cdn.mozilla.net/fonts/fira.css'>
<link rel='stylesheet' href='/css/site.css?v=2' type='text/css'/>
<link rel='stylesheet' href='/css/custom.css' type='text/css'/>
<link rel='stylesheet' href='/css/syntax-coloring.css' type='text/css'/>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../"> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><header id="top" class="status">
<div class="intro">
  <img
    src="/images/Lisplogo_alien_256.png"
    alt="Land of Lisp"
    class="no-border"
  />
  <h1>
    <span class="gray">Zhao</span>
    <span class="black">Wei</span>
  </h1>
  <p>
    How can man die better than facing fearful odds, for the ashes of his
    fathers and the temples of his Gods? -- By Horatius.
  </p>
</div>

<div class="nav">
  <ul>
    <li><a href="/">Posts</a>.</li>
    <li><a href="/about/">About</a>.</li>
  </ul>
</div>
</header>
<main id="content">
<header>
<h1 class="title">AWS Notes</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgedf1ed3">1. ECS</a>
<ul>
<li><a href="#org4333a0c">1.1. Refs</a></li>
<li><a href="#org39e7df8">1.2. Concepts</a>
<ul>
<li><a href="#org89247f8">1.2.1. ECS</a></li>
<li><a href="#org6995fc1">1.2.2. EC2</a></li>
<li><a href="#org5b6da5e">1.2.3. Farget and EC2</a></li>
<li><a href="#orgeed8747">1.2.4. Task Definitions</a></li>
<li><a href="#org613091c">1.2.5. Cluster</a></li>
</ul>
</li>
<li><a href="#orgad89619">1.3. Features of ECS</a></li>
<li><a href="#orge4647f0">1.4. Steps to use ECS</a></li>
<li><a href="#org1259491">1.5. <span class="todo TODO">TODO</span> About AutoScaling of EC2</a>
<ul>
<li><a href="#orgdc543ea">1.5.1. Similar example from App-worker-manager</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd75d72b">2. Route53</a>
<ul>
<li><a href="#org606ffa4">2.1. Switch traffic to different domain name as failover</a></li>
<li><a href="#orgb1a2724">2.2. LoadBalancer in ECS</a></li>
</ul>
</li>
<li><a href="#org186dde4">3. AWS Security</a>
<ul>
<li><a href="#orgb1e4af1">3.1. refs</a></li>
<li><a href="#orgf22d6c0">3.2. My notes</a>
<ul>
<li><a href="#org678523d">3.2.1. Office building analogy</a></li>
<li><a href="#org311ad26">3.2.2. VPC</a></li>
<li><a href="#org06d8a89">3.2.3. Subnets</a></li>
<li><a href="#orge3adf02">3.2.4. Security Group</a></li>
<li><a href="#org997f158">3.2.5. Launch instance into VPC</a></li>
<li><a href="#org4708299">3.2.6. Bastion host</a></li>
</ul>
</li>
<li><a href="#orgdfcdf6d">3.3. My summary</a></li>
</ul>
</li>
<li><a href="#org4826d33">4. ECR</a></li>
<li><a href="#org2681450">5. Troubleshootings</a></li>
<li><a href="#org010a498">6. <span class="todo TODO">TODO</span> VPC</a>
<ul>
<li><a href="#org4510ea0">6.1. Refs</a></li>
<li><a href="#orgcec3a8a">6.2. VPC networking components</a></li>
</ul>
</li>
<li><a href="#org7471e1d">7. CloudFormation Skills</a>
<ul>
<li><a href="#orga877348">7.1. Use FindInMap to customize environment variables based on keys</a></li>
</ul>
</li>
<li><a href="#org773ed9e">8. My notes</a>
<ul>
<li><a href="#orgf7c2d84">8.1. Network Fundamentals</a></li>
</ul>
</li>
</ul>
</div>
</nav>

<section id="outline-container-orgedf1ed3" class="outline-2">
<h2 id="orgedf1ed3"><span class="section-number-2">1</span> ECS</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org4333a0c" class="outline-3">
<h3 id="org4333a0c"><span class="section-number-3">1.1</span> Refs</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><a href="https://stackoverflow.com/questions/42960678/what-is-the-difference-between-a-task-and-a-service-in-aws-ecs">What is the difference between a task and a service in AWS ECS?</a><br></li>
<li><a href="https://medium.com/boltops/gentle-introduction-to-how-aws-ecs-works-with-example-tutorial-cea3d27ce63d">Gentle Introduction to How AWS ECS Works with Example Tutorial</a><br></li>
</ul>
</div>
</div>
<div id="outline-container-org39e7df8" class="outline-3">
<h3 id="org39e7df8"><span class="section-number-3">1.2</span> Concepts</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org89247f8" class="outline-4">
<h4 id="org89247f8"><span class="section-number-4">1.2.1</span> ECS</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li>abbreviation  for <b>Elastic Container Service</b>. It is a container <b>management</b> service for containers on a cluster.<br></li>
<li><b>Task Definition</b> defines one or multiple containers to construct as a application.<br></li>
<li>A <b>Task</b> is an instance of task definition.<br></li>
<li>A <b>Service</b> is used to guarantee that you always have some number of Tasks running at all times. Such as, make sure there are always 3 running task across different zones.<br></li>
<li>A <b>Cluster</b> is used to manage a collection of resources such as CPU, memory, etc.<br></li>
</ul>
</div>
</div>
<div id="outline-container-org6995fc1" class="outline-4">
<h4 id="org6995fc1"><span class="section-number-4">1.2.2</span> EC2</h4>
<div class="outline-text-4" id="text-1-2-2">
<ul class="org-ul">
<li>Short for <b>Elastic Compute Cloud (Amazon EC2)</b> <br></li>
</ul>
</div>
</div>
<div id="outline-container-org5b6da5e" class="outline-4">
<h4 id="org5b6da5e"><span class="section-number-4">1.2.3</span> Farget and EC2</h4>
<div class="outline-text-4" id="text-1-2-3">
<ul class="org-ul">
<li>Both are cluster service types.<br></li>
<li>Farget doesn&rsquo;t need server. It still need docker image.<br></li>
<li>EC2 need server and allow you to have more control on it.<br></li>
</ul>
</div>
</div>
<div id="outline-container-orgeed8747" class="outline-4">
<h4 id="orgeed8747"><span class="section-number-4">1.2.4</span> <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html">Task Definitions</a></h4>
<div class="outline-text-4" id="text-1-2-4">
<ul class="org-ul">
<li>describes one or more <b>containers</b>, up to 10<br></li>
<li>blueprint for your application:<br>
<ul class="org-ul">
<li>which containers/image to use<br></li>
<li>which launch type ?<br></li>
<li>which port<br></li>
<li>what data volumes should be used with the containers<br></li>
</ul></li>
<li><a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/example_task_definitions.html">Different task examples</a><br></li>
<li>A <b>task is the instantiation of a task definition within a cluster</b>.<br></li>
<li>A <b>Service runs and maintains a specified number of tasks</b>.<br></li>
</ul>
</div>
</div>

<div id="outline-container-org613091c" class="outline-4">
<h4 id="org613091c"><span class="section-number-4">1.2.5</span> Cluster</h4>
<div class="outline-text-4" id="text-1-2-5">
<ul class="org-ul">
<li>A logical grouping of resources.<br></li>
<li>For Fargate type, AWS ECS manages cluster resources automatically.<br></li>
<li>For EC2, you need to manage a group of container instances.<br></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgad89619" class="outline-3">
<h3 id="orgad89619"><span class="section-number-3">1.3</span> Features of ECS</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>provide high available manner for<br>
<ul class="org-ul">
<li>across multiple zones<br></li>
<li>within one Region<br></li>
</ul></li>
<li>schedule the placement of containers across your cluster based on:<br>
<ul class="org-ul">
<li>your resource needs<br></li>
<li>isolation policies<br></li>
<li>availability requirements<br></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orge4647f0" class="outline-3">
<h3 id="orge4647f0"><span class="section-number-3">1.4</span> Steps to use ECS</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>Define VPC<br></li>
<li>Create clusters within a new or existing VPC.<br></li>
<li>Create tasks (from task definition) to run in Service in Cluster.<br>
<ul class="org-ul">
<li>Running task is instance of task definition.<br></li>
</ul></li>
<li>For ECS, you need to group task definition with service description.<br>
<ul class="org-ul">
<li>Running task is instance of Service which is {task definition, Service description}<br></li>
</ul></li>
<li>Docker image is created for tasks, and it is prepared in AWS ECR or Docker-Hub<br></li>
</ul>
</div>
</div>

<div id="outline-container-org1259491" class="outline-3">
<h3 id="org1259491"><span class="section-number-3">1.5</span> <span class="todo TODO">TODO</span> About AutoScaling of EC2</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>ref: <a href="https://aws.amazon.com/blogs/containers/deep-dive-on-amazon-ecs-cluster-auto-scaling/">Deep Dive on Amazon ECS Cluster Auto Scaling</a><br></li>
</ul>
</div>

<div id="outline-container-orgdc543ea" class="outline-4">
<h4 id="orgdc543ea"><span class="section-number-4">1.5.1</span> Similar example from App-worker-manager</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Worker manager relies on two tables.<br>
</p>
<ul class="org-ul">
<li><p>
<code>app-dummy-service-task-definitions-drdev</code>, its schema:<br>
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Pooling</td>
<td class="org-left">ScaleTo</td>
<td class="org-left">TaskArn</td>
<td class="org-left">TaskDef</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>It manages pool. Pool lists all the workers available to use.<br></li>
<li>It acts as a <b>plan table</b> (like how much memory I should need). It records:<br>
<ul class="org-ul">
<li>For a specific version, how many I should keep it in hot pool.<br></li>
<li>For a speicif version, it is used/defined in which ECS task definition.<br></li>
</ul></li>
<li>The value for TaskArn and TaskDef is generated from <b>worker-pipeline</b>:<br>
<ul class="org-ul">
<li>After pushing worker into ECR, a new ECS task definition for worker is generated for new available worker. Worker manager will use this worker-task-definition to star worker.<br></li>
</ul></li>
</ul></li>
<li><p>
<code>app-worker-manager-hotpool-drdev</code>, its schema:<br>
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">UUID</td>
<td class="org-left">DT</td>
<td class="org-left">Available</td>
<td class="org-left">Ip</td>
<td class="org-left">Port</td>
<td class="org-left">ServiceApiId</td>
<td class="org-left">TaskArn</td>
<td class="org-left">TaskDefArn</td>
<td class="org-left">WorkerVersion</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>It acts as a <b>implementation/progress table</b> for the <code>app-dummy-service-task-definitions-drdev</code>, plan table.<br>
<ul class="org-ul">
<li>How to allocate those memory(worker), or which worker version is used in which ECS task instance.<br></li>
<li>For example, if the plan table set <code>ScaleTo=6</code> and <code>Pooling=Y</code> for <code>TaskDef=NX119</code>. Then, this implementation table will add 6 records. They show where those 6 workers have been used in which ECS task instances.<br></li>
</ul></li>
<li>After &ldquo;the memory has been allocated&rdquo;, if there are clients coming in and used those worker (consume some/all those memory). Then, in the next checking point (every 15mins), worker manager will need to allocate new workers as planed.<br></li>
</ul></li>
<li>A related table, <code>app-dummy-service-data-drdev</code>.<br>
<ul class="org-ul">
<li>This table records all the client activities which also includes which worker has been used for what purpose.<br></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="outline-container-orgd75d72b" class="outline-2">
<h2 id="orgd75d72b"><span class="section-number-2">2</span> Route53</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>To make Route53 works, you need to create 2 records: one is type A, another is CNAME which is created during validate certificate.<br></li>
</ul>
</div>
<div id="outline-container-org606ffa4" class="outline-3">
<h3 id="org606ffa4"><span class="section-number-3">2.1</span> Switch traffic to different domain name as failover</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Task description<br>
<ul class="org-ul">
<li>Given two domains: <code>lb.dev.app.com</code> as primary service and <code>lb.drdev.app.com</code> secondary service, we want to create another hosted zone in Route53 <code>acs.app.com</code>.<br></li>
<li>In normal case, we let <code>dev.acs.app.com</code> to route traffice to <code>lb.dev.app.com</code>.<br></li>
<li>In disaster case, we let <code>dev.acs.app.com</code> to route traffice to <code>lb.drdev.app.com</code>.<br></li>
</ul></li>
<li>Steps<br>
<ul class="org-ul">
<li>Create new hosted zone <code>acs.app.com</code> in Route53.<br>
<ul class="org-ul">
<li><b>If public hosted zone is a third level domain, then add the NS records of this zone to the parent hosted zone</b>.<br></li>
</ul></li>
<li>Within <code>acs.app.com</code>, create record<br>
<ul class="org-ul">
<li>Routing policy -&gt; Simple routing, next<br></li>
<li>Define simple record:<br>
<ul class="org-ul">
<li>Record name: <code>dev.acs.app.com</code><br></li>
<li>Record type: <code>CNAME -- Routes traffice to another domain name and to some AWS resources</code><br></li>
<li>Value/Route traffice to:<br>
<ul class="org-ul">
<li><code>IP address or another value depending on the record type</code><br></li>
<li><code>lb.dev.app.com</code><br></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li>Troubleshooting01: Could not resolve host: dev.acs.app.com<br>
<ul class="org-ul">
<li><p>
After created CNAME <code>dev.acs.app.com</code> to <code>lb.dev.app.com</code>, we should be able to visit resources under <code>dev.acs.app.com</code> as we visit <code>lb.dev.app.com</code>.<br>
</p>
<div class="org-src-container">
<pre class="src src-sh">curl https://lb.dev.app.com/app/health
{<span class="org-string">"status"</span>:<span class="org-string">"ok"</span>,<span class="org-string">"ts"</span>:1598240637924,<span class="org-string">"local"</span>:<span class="org-string">"8/24/2020, 3:43:57 AM"</span>,<span class="org-string">"utc"</span>:<span class="org-string">"Mon, 24 Aug 2020 03:43:57 GMT"</span>}

curl https://dev.acs.app.com/app/health
curl: (6) Could not resolve host: dev.acs.app.com
</pre>
</div>
<ul class="org-ul">
<li>I forget to add the NS records of hosted zone <code>acs.app.com</code> to its parent hosted zone <code>app.com</code>. After doing so, the DNS resolution shows the following result.<br></li>
</ul></li>
<li>Domain name resolve in Ubuntu<br>
<ul class="org-ul">
<li><p>
Resolve <code>lb.dev.app.com</code> (endpoint for app-dev)<br>
</p>
<div class="org-src-container">
<pre class="src src-sh">dig lb.dev.app.com

; &lt;&lt;&gt;&gt; DiG 9.11.3-1ubuntu1.13-Ubuntu &lt;&lt;&gt;&gt; lb.dev.app.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 14519
<span class="org-sh-heredoc">;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1</span>

<span class="org-sh-heredoc">;; OPT PSEUDOSECTION:</span>
<span class="org-sh-heredoc">; EDNS: version: 0, flags:; udp: 65494</span>
<span class="org-sh-heredoc">;; QUESTION SECTION:</span>
<span class="org-sh-heredoc">;lb.dev.app.com.            IN      A</span>

<span class="org-sh-heredoc">;; ANSWER SECTION:</span>
<span class="org-sh-heredoc">lb.dev.app.com.     0       IN      A       34.195.245.88</span>
<span class="org-sh-heredoc">lb.dev.app.com.     0       IN      A       34.197.127.0</span>
<span class="org-sh-heredoc">lb.dev.app.com.     0       IN      A       52.7.50.34</span>

<span class="org-sh-heredoc">;; Query time: 80 msec</span>
<span class="org-sh-heredoc">;; SERVER: 127.0.0.53#53(127.0.0.53)</span>
<span class="org-sh-heredoc">;; WHEN: Mon Aug 24 13:27:16 CST 2020</span>
<span class="org-sh-heredoc">;; MSG SIZE  rcvd: 95</span>
</pre>
</div></li>
<li><p>
Resolve <code>dev.acs.app.com</code><br>
</p>
<div class="org-src-container">
<pre class="src src-sh">dig dev.acs.app.com

; &lt;&lt;&gt;&gt; DiG 9.11.3-1ubuntu1.13-Ubuntu &lt;&lt;&gt;&gt; dev.acs.app.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 39460
<span class="org-sh-heredoc">;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1</span>

<span class="org-sh-heredoc">;; OPT PSEUDOSECTION:</span>
<span class="org-sh-heredoc">; EDNS: version: 0, flags:; udp: 65494</span>
<span class="org-sh-heredoc">;; QUESTION SECTION:</span>
<span class="org-sh-heredoc">;dev.acs.app.com.           IN      A</span>

<span class="org-sh-heredoc">;; ANSWER SECTION:</span>
<span class="org-sh-heredoc">dev.acs.app.com.    0       IN      CNAME   lb.dev.app.com.</span>
<span class="org-sh-heredoc">lb.dev.app.com.     0       IN      A       52.7.50.34</span>
<span class="org-sh-heredoc">lb.dev.app.com.     0       IN      A       34.197.127.0</span>
<span class="org-sh-heredoc">lb.dev.app.com.     0       IN      A       34.195.245.88</span>

<span class="org-sh-heredoc">;; Query time: 81 msec</span>
<span class="org-sh-heredoc">;; SERVER: 127.0.0.53#53(127.0.0.53)</span>
<span class="org-sh-heredoc">;; WHEN: Mon Aug 24 13:29:06 CST 2020</span>
<span class="org-sh-heredoc">;; MSG SIZE  rcvd: 117</span>
</pre>
</div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgb1a2724" class="outline-3">
<h3 id="orgb1a2724"><span class="section-number-3">2.2</span> LoadBalancer in ECS</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-yaml"><span class="org-variable-name">AppService</span>:
  <span class="org-variable-name">Type</span>: AWS::ECS::Service
  <span class="org-variable-name">DependsOn</span>:
    - ALBListenerRule
    <span class="org-comment-delimiter">#</span><span class="org-comment">- ServiceRole</span>
  <span class="org-variable-name">Properties</span>:
    <span class="org-variable-name">Cluster</span>: <span class="org-type">!ImportValue</span>
      <span class="org-variable-name">Fn::Sub</span>: ${ECSStackName}-ECSCluster
    <span class="org-variable-name">DesiredCount</span>: <span class="org-type">!FindInMap</span>
      - EnvironmentMap
      - <span class="org-type">!Ref</span> <span class="org-string">'ConfigEnvironment'</span>
      - DesiredCount
    <span class="org-variable-name">LoadBalancers</span>:
      - <span class="org-variable-name">ContainerName</span>: altas-service
<span class="org-yaml-tab">        </span><span class="org-variable-name">ContainerPort</span>: <span class="org-string">'8080'</span>
<span class="org-yaml-tab">        </span><span class="org-variable-name">TargetGroupArn</span>: <span class="org-type">!Ref</span> <span class="org-string">'ECSTG'</span>
      - <span class="org-variable-name">ContainerName</span>: altas-service
<span class="org-yaml-tab">        </span><span class="org-variable-name">ContainerPort</span>: <span class="org-string">'8080'</span>
<span class="org-yaml-tab">        </span><span class="org-variable-name">TargetGroupArn</span>: <span class="org-type">!Ref</span> <span class="org-string">'ECSTGALB'</span>
    <span class="org-comment-delimiter">#</span><span class="org-comment">Role: !Ref 'ServiceRole'</span>
    <span class="org-variable-name">TaskDefinition</span>: <span class="org-type">!Ref</span> <span class="org-string">'TaskDefinition'</span>
    <span class="org-variable-name">PlacementStrategies</span>:
      - <span class="org-variable-name">Field</span>: attribute:ecs.availability-zone
<span class="org-yaml-tab">        </span><span class="org-variable-name">Type</span>: spread
      - <span class="org-variable-name">Field</span>: memory
<span class="org-yaml-tab">        </span><span class="org-variable-name">Type</span>: binpack        
<span class="org-variable-name">ECSTGALB</span>:
  <span class="org-variable-name">Type</span>: AWS::ElasticLoadBalancingV2::TargetGroup
  <span class="org-variable-name">Properties</span>:
    <span class="org-variable-name">HealthCheckIntervalSeconds</span>: 10
    <span class="org-variable-name">HealthCheckPath</span>: /health
    <span class="org-variable-name">HealthCheckProtocol</span>: HTTP
    <span class="org-variable-name">HealthyThresholdCount</span>: 2
    <span class="org-variable-name">Port</span>: 80
    <span class="org-variable-name">Protocol</span>: HTTP
    <span class="org-variable-name">UnhealthyThresholdCount</span>: 2
    <span class="org-variable-name">VpcId</span>: <span class="org-type">!ImportValue</span>
      <span class="org-variable-name">Fn::Sub</span>: ${VPCStackName}-VPCId
    <span class="org-variable-name">TargetGroupAttributes</span>:
      - <span class="org-variable-name">Key</span>: deregistration_delay.timeout_seconds
<span class="org-yaml-tab">        </span><span class="org-variable-name">Value</span>: <span class="org-string">'20'</span>
<span class="org-variable-name">ALBListenerRule</span>:  
  <span class="org-variable-name">Type</span>: AWS::ElasticLoadBalancingV2::ListenerRule
  <span class="org-variable-name">DependsOn</span>:
    - ECSTGALB
  <span class="org-variable-name">Properties</span>:
    <span class="org-variable-name">Actions</span>:
      - <span class="org-variable-name">Type</span>: forward
<span class="org-yaml-tab">        </span><span class="org-variable-name">TargetGroupArn</span>: <span class="org-type">!Ref</span> <span class="org-string">'ECSTGALB'</span>
    <span class="org-variable-name">Conditions</span>:
      - <span class="org-variable-name">Field</span>: path-pattern
<span class="org-yaml-tab">        </span><span class="org-variable-name">Values</span>:
<span class="org-yaml-tab">        </span>  - /app/*
    <span class="org-variable-name">ListenerArn</span>: <span class="org-type">!ImportValue</span>
      <span class="org-variable-name">Fn::Sub</span>: app-alb-${StackEnvironment}-AppPubALBListenerArn
    <span class="org-variable-name">Priority</span>: <span class="org-string">'5'</span>
<span class="org-variable-name">ALBListener</span>:
  <span class="org-variable-name">Type</span>: AWS::ElasticLoadBalancingV2::Listener
  <span class="org-comment-delimiter">#</span><span class="org-comment">DependsOn: ServiceRole</span>
  <span class="org-variable-name">Properties</span>:
    <span class="org-variable-name">DefaultActions</span>:
      - <span class="org-variable-name">Type</span>: forward
<span class="org-yaml-tab">        </span><span class="org-variable-name">TargetGroupArn</span>: <span class="org-type">!Ref</span> <span class="org-string">'ECSTG'</span>
    <span class="org-variable-name">LoadBalancerArn</span>: <span class="org-type">!Ref</span> <span class="org-string">'ECSALB'</span>
    <span class="org-variable-name">Port</span>: <span class="org-string">'80'</span>
    <span class="org-variable-name">Protocol</span>: TCP
<span class="org-variable-name">ECSALB</span>:
  <span class="org-variable-name">Type</span>: AWS::ElasticLoadBalancingV2::LoadBalancer
  <span class="org-variable-name">Properties</span>:
    <span class="org-variable-name">Type</span>: network
    <span class="org-variable-name">Scheme</span>: internal
    <span class="org-variable-name">Name</span>: <span class="org-type">!Sub</span> <span class="org-string">'${VPCStackName}-NLB'</span>
    <span class="org-variable-name">Subnets</span>: <span class="org-type">!If</span>
      - ThirdAZ
      - - <span class="org-type">!ImportValue</span>
<span class="org-yaml-tab">        </span><span class="org-variable-name">  Fn::Sub</span>: ${VPCStackName}-PrivateSubnet1
<span class="org-yaml-tab">        </span>- <span class="org-type">!ImportValue</span>
<span class="org-yaml-tab">        </span><span class="org-variable-name">  Fn::Sub</span>: ${VPCStackName}-PrivateSubnet2
<span class="org-yaml-tab">        </span>- <span class="org-type">!ImportValue</span>
<span class="org-yaml-tab">        </span><span class="org-variable-name">  Fn::Sub</span>: ${VPCStackName}-PrivateSubnet3
      - - <span class="org-type">!ImportValue</span>
<span class="org-yaml-tab">        </span><span class="org-variable-name">  Fn::Sub</span>: ${VPCStackName}-PrivateSubnet1
<span class="org-yaml-tab">        </span>- <span class="org-type">!ImportValue</span>
<span class="org-yaml-tab">        </span><span class="org-variable-name">  Fn::Sub</span>: ${VPCStackName}-PrivateSubnet2
    <span class="org-variable-name">LoadBalancerAttributes</span>:
      - <span class="org-variable-name">Key</span>: load_balancing.cross_zone.enabled
<span class="org-yaml-tab">        </span><span class="org-variable-name">Value</span>: <span class="org-string">'true'</span>
<span class="org-variable-name">ECSTG</span>:
  <span class="org-variable-name">Type</span>: AWS::ElasticLoadBalancingV2::TargetGroup
  <span class="org-variable-name">DependsOn</span>: ECSALB
  <span class="org-variable-name">Properties</span>:
    <span class="org-variable-name">HealthCheckIntervalSeconds</span>: 10
    <span class="org-variable-name">HealthCheckPath</span>: /health
    <span class="org-variable-name">HealthCheckProtocol</span>: HTTP
    <span class="org-variable-name">HealthyThresholdCount</span>: 2
    <span class="org-variable-name">Port</span>: 80
    <span class="org-variable-name">Protocol</span>: TCP
    <span class="org-variable-name">UnhealthyThresholdCount</span>: 2
    <span class="org-variable-name">VpcId</span>: <span class="org-type">!ImportValue</span>
      <span class="org-variable-name">Fn::Sub</span>: ${VPCStackName}-VPCId
    <span class="org-variable-name">TargetGroupAttributes</span>:
      - <span class="org-variable-name">Key</span>: deregistration_delay.timeout_seconds
<span class="org-yaml-tab">        </span><span class="org-variable-name">Value</span>: <span class="org-string">'20'</span>                           
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-org186dde4" class="outline-2">
<h2 id="org186dde4"><span class="section-number-2">3</span> AWS Security</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgb1e4af1" class="outline-3">
<h3 id="orgb1e4af1"><span class="section-number-3">3.1</span> refs</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li><a href="https://cloudacademy.com/blog/aws-shared-responsibility-model-security/">AWS Shared Responsibility Model: Cloud Security</a><br></li>
<li><a href="https://cloudacademy.com/blog/aws-security-groups-instance-level-security/">AWS Security Groups: Instance Level Security</a><br></li>
<li><a href="https://cloudacademy.com/blog/aws-network-acl-vpc-subnets-network-security/">AWS Network ACL and subnets: network level security</a><br></li>
<li><a href="https://cloudacademy.com/blog/aws-bastion-host-nat-instances-vpc-peering-security/">AWS Security: Bastion Hosts, NAT instances and VPC Peering</a><br></li>
<li><a href="https://www.rackspace.com/blog/aws-201-understanding-the-default-virtual-private-cloud">Understanding the Default Virtual Private Cloud (VPC)</a><br></li>
<li><a href="https://www.infoq.com/articles/aws-vpc-explained/">AWS VPC Subnets</a><br></li>
</ul>
</div>
</div>

<div id="outline-container-orgf22d6c0" class="outline-3">
<h3 id="orgf22d6c0"><span class="section-number-3">3.2</span> My notes</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>Different models have differences on how security responsibility are devided (where AWS and customer responsibility start and end)<br>
<ul class="org-ul">
<li>model for infrastructure services<br></li>
<li>model for container services<br></li>
<li>model for abstrac services<br></li>
</ul></li>
<li>In <b>infrastructure services</b>, customer needs to look after:<br>
<ul class="org-ul">
<li>client and server side encryption<br></li>
<li>network traffic protection<br></li>
<li>security of the operating system<br></li>
<li>network<br></li>
<li>firewall configuration<br></li>
<li>application security<br></li>
<li>identity and access management<br></li>
</ul></li>
<li>Container services model has much less requirement for customer<br></li>
<li>Abstract  services model has least requirement for customer<br></li>
</ul>
</div>

<div id="outline-container-org678523d" class="outline-4">
<h4 id="org678523d"><span class="section-number-4">3.2.1</span> Office building analogy</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li>Think of your office as a multi-story building<br></li>
<li>Each floor has multiple suites<br></li>
<li>Each department like HR, Payroll can sit in one floor (or) multiple floors<br></li>
<li>Every suite has few rooms<br></li>
<li><p>
Each room has couple of desk where employees work<br>
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">AWS</th>
<th scope="col" class="org-left">Company</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Region</td>
<td class="org-left">Office building</td>
</tr>

<tr>
<td class="org-left">Availability Zone</td>
<td class="org-left">Each floor</td>
</tr>

<tr>
<td class="org-left">VPC</td>
<td class="org-left">Each department</td>
</tr>

<tr>
<td class="org-left">Subnet</td>
<td class="org-left">Each suite</td>
</tr>

<tr>
<td class="org-left">IP</td>
<td class="org-left">Each desk</td>
</tr>
</tbody>
</table></li>
<li><p>
When company assign desk to employee vs Launch AWS EC2 instance<br>
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Assign desk</th>
<th scope="col" class="org-left">Launch EC2 instance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Which department this employee belongs to</td>
<td class="org-left">We need to pick which VPC this instance should be deployed to</td>
</tr>

<tr>
<td class="org-left">Then identifies which floors the department spans across</td>
<td class="org-left">Then we pick which availability zone (if not, default availability zone)</td>
</tr>

<tr>
<td class="org-left">Then identifies which suites have open desks</td>
<td class="org-left">Then we pick the subnet (if not default subnet)</td>
</tr>

<tr>
<td class="org-left">Assigns one of the open desks to the employee</td>
<td class="org-left">Then an IP from this subnet gets assigned to our EC2 instance (as private IP)</td>
</tr>
</tbody>
</table></li>
<li>Other associated terminologies<br>
<ul class="org-ul">
<li>Security groups like access card<br></li>
</ul></li>
</ul>
</div>
</div>


<div id="outline-container-org311ad26" class="outline-4">
<h4 id="org311ad26"><span class="section-number-4">3.2.2</span> VPC</h4>
<div class="outline-text-4" id="text-3-2-2">
<ul class="org-ul">
<li>What is it?<br>
<ul class="org-ul">
<li>Whenever you launch an instance within your AWS account, by default it will be launched into a default VPC and gets public IP and private IP.<br></li>
<li>A logical virtual network spanning an entire AWS region (one region &#x2013; one default VPC, can create multiple VPCs in a region).<br></li>
</ul></li>
<li>Six components are created as default parts of VPC<br>
<ul class="org-ul">
<li>VPC CIDR block<br>
<ul class="org-ul">
<li>Every VPC is associated with an IP address range that is part of a <b>Classless Inter-Domain Routing (CIDR)</b> block which will be used to allocated private IP addresses to EC2 instances.<br></li>
</ul></li>
<li><a href="#org06d8a89">Subnets</a><br>
<ul class="org-ul">
<li>a subnet is associated with only one availability zone (can not span multiple zones)<br></li>
<li>However, a zone can host multiple subnets.<br></li>
<li>Each subnet in a VPC is associated with an IPv4 CIDR block that is a a subset of the /16 CIDR block of its VPC.<br></li>
</ul></li>
<li>Internet gateway<br>
<ul class="org-ul">
<li>Provide connectivity to outside AWS (internet)<br></li>
<li>A VPC must be attached to an Internet gateway to communicate with internet. Only one IGW can be attached to a VPC at a time.<br></li>
<li>Bi-direction source and destination network address translation for your EC2 instances.<br></li>
</ul></li>
<li>Route table<br>
<ul class="org-ul">
<li>Every subnet must be associated with a route table.<br></li>
<li>If the association is not explicitly defined, then a subnet will be implicitly associated with the main route table.<br></li>
</ul></li>
<li>Network access control lists (ACLs)<br></li>
<li><a href="#orge3adf02">Security Group</a><br></li>
<li>VPC endpoint<br></li>
</ul></li>
<li>AWS provides security mechanisms for your instances in the form of <b>network ACLs and security groups</b>.<br></li>
</ul>
</div>
</div>

<div id="outline-container-org06d8a89" class="outline-4">
<h4 id="org06d8a89"><span class="section-number-4">3.2.3</span> Subnets</h4>
<div class="outline-text-4" id="text-3-2-3">
<ul class="org-ul">
<li>A subnet is a distinct network segment with its own IP address range within the larger VPC CIDR (Classless Inter-Domain Routing) range.<br></li>
<li>A VPC and have all public or public/private subnet combination.<br>
<ul class="org-ul">
<li>A public subnet is defined by its connection (through a Routing Table) to an <b>Internet Gateway (IGW)</b> within your VPC.<br></li>
<li>Any subnet without a route to the IGW is considered private.<br></li>
</ul></li>
<li>A private subnet is a subnet which doesn&rsquo;t have a route to the internet gateway.<br></li>
<li><b>Steps to create a public subnet</b><br>
<ol class="org-ol">
<li>VPC &#x2013;&gt; create subnet<br>
<ul class="org-ul">
<li>select the VPC within which you want to create the subnet<br></li>
<li>select availability zone<br></li>
<li>enter CIDR block<br></li>
</ul></li>
<li>Add an IGW<br></li>
<li>Attach IGW to a VPC<br></li>
<li>Add a route to the IGW from your subnet<br>
<ul class="org-ul">
<li>Route Tables &#x2013;&gt; Create Route Table<br></li>
<li>Select your VPC, select &ldquo;Create&rdquo;<br></li>
<li>Edit the Route Table just created, give it a route to the outside world<br>
<ul class="org-ul">
<li>Add another route<br></li>
<li>Enter &rsquo;0.0.0.0/0&rsquo; in Destination (to allow access to any Internet address)<br></li>
<li>Enter your IGW ID in the &rsquo;Target&rsquo; field.  Save it.<br></li>
</ul></li>
</ul></li>
<li>Associate your route table with your subnet<br>
<ul class="org-ul">
<li>Select &rsquo;Subnet Associations&rsquo; (while selecting the route table you created, the sections below show different sections)<br></li>
<li>Select the subnets you wish to associate with this route table using the check box and click &ldquo;save&rdquo;.<br></li>
</ul></li>
</ol></li>
</ul>
</div>
</div>

<div id="outline-container-orge3adf02" class="outline-4">
<h4 id="orge3adf02"><span class="section-number-4">3.2.4</span> Security Group</h4>
<div class="outline-text-4" id="text-3-2-4">
<ul class="org-ul">
<li>AWS security groups (SGs) are associated with <b>EC2 instances</b> and provide security at the <b>protocol and port access level</b>.<br></li>
<li>Working much the same way as a firewall:<br>
<ul class="org-ul">
<li>a set of rules filter traffic coming into and out of an EC2 instance.<br></li>
</ul></li>
<li>Security groups are specific to a VPC (which VPC the SG will reside).<br></li>
</ul>
</div>
</div>

<div id="outline-container-org997f158" class="outline-4">
<h4 id="org997f158"><span class="section-number-4">3.2.5</span> Launch instance into VPC</h4>
<div class="outline-text-4" id="text-3-2-5">
<ul class="org-ul">
<li>Before launch<br>
<ol class="org-ol">
<li>identify the subnet where this instance need to be launched into.<br></li>
<li>identify an available zone.<br></li>
</ol></li>
<li>After launch (Once an instance is created within the VPC/Subnet/Availability Zone)<br>
<ul class="org-ul">
<li>If the you launch the instance into a subnet that has assign public ip address attribute enabled, a public IP address is assigned to the primary network interface (eth0) of the created instance.<br></li>
<li>A public IP is mapped to the primary private IP through NAT. The public IP will change whenever you stop EC2 instance and start it again.<br></li>
<li>Notic: that public IP is not the AWS Elastic IP (EIP).<br></li>
</ul></li>
</ul>
</div>
</div>


<div id="outline-container-org4708299" class="outline-4">
<h4 id="org4708299"><span class="section-number-4">3.2.6</span> Bastion host</h4>
<div class="outline-text-4" id="text-3-2-6">
<ul class="org-ul">
<li>Bastion hosts are instances that sit within your public subnet and are typically accessed using SSH or RDP, as jump server.<br></li>
<li>Purpose: use SSH to log into other instances (within private subnets) deeper within your VPC.<br></li>
<li>If you require remote connectivity with your private instances over the public internet, then you need it.<br></li>
<li><b>Basic steps to create a bastion host</b><br>
<ol class="org-ol">
<li>Launch an EC2 instance as you normally would for any other instance.<br></li>
<li>Apply OS hardening as required.<br></li>
<li>Set up the appropriate security groups (SG).<br></li>
<li>Implement either SSH-agent forwarding (Linux connectivity) or Remote Desktop Gateway (Windows connectivity).<br></li>
<li>Deploy an AWS bastion host in each of the Availability Zones you&rsquo;re using.<br></li>
</ol></li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgdfcdf6d" class="outline-3">
<h3 id="orgdfcdf6d"><span class="section-number-3">3.3</span> My summary</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>EC2 instance level security is controled by security groups which applies restrictions on instance&rsquo;s protocol and port level.<br></li>
<li>Network level security is controled by applying network ACLs on subnets (equivalent of the security groups attached to EC2 instances).<br></li>
</ul>
</div>
</div>
</section>

<section id="outline-container-org4826d33" class="outline-2">
<h2 id="org4826d33"><span class="section-number-2">4</span> ECR</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li><p>
pull image from ECR<br>
</p>
<div class="org-src-container">
<pre class="src src-sh"><span class="org-builtin">eval</span> $(<span class="org-sh-quoted-exec">aws</span> ecr get-login --no-include-email --region us-east-1 --profile=default)
</pre>
</div>
<ul class="org-ul">
<li>Need to specify in which region you want to login.<br></li>
</ul></li>
</ul>
</div>
</section>
<section id="outline-container-org2681450" class="outline-2">
<h2 id="org2681450"><span class="section-number-2">5</span> Troubleshootings</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li><a href="file:///home/zw/code/capture-org/siemens/work-notes.html#orgb94319e">Cloudfront distribution: the domain name assigned by aws could be visited, but the cname used is not avaiable.</a><br></li>
<li><a href="file:///home/zw/code/capture-org/siemens/work-notes.html#orgde1c51f">Cloudfront distribution: The certificate that is attached to your distribution doesn&rsquo;t cover the alternate domain name (CNAME) that you&rsquo;re trying to add.</a><br></li>
</ul>
</div>
</section>




<section id="outline-container-org010a498" class="outline-2">
<h2 id="org010a498"><span class="section-number-2">6</span> <span class="todo TODO">TODO</span> VPC</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org4510ea0" class="outline-3">
<h3 id="org4510ea0"><span class="section-number-3">6.1</span> Refs</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li><a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html">Amazon Virtual Private Cloud</a><br></li>
</ul>
</div>
</div>
<div id="outline-container-orgcec3a8a" class="outline-3">
<h3 id="orgcec3a8a"><span class="section-number-3">6.2</span> VPC networking components</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>Networking interfaces<br></li>
<li>Route tables<br></li>
<li>Prefix lists<br></li>
<li>NAT<br>
<ul class="org-ul">
<li>NAT gateways<br></li>
<li>NAT instances<br></li>
</ul></li>
<li>DHCP options sets<br></li>
<li>DNS<br></li>
<li>VPC peering<br></li>
<li>Elastic IP address<br></li>
<li>ClassicLink<br></li>
</ul>
</div>
</div>
</section>

<section id="outline-container-org7471e1d" class="outline-2">
<h2 id="org7471e1d"><span class="section-number-2">7</span> CloudFormation Skills</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orga877348" class="outline-3">
<h3 id="orga877348"><span class="section-number-3">7.1</span> Use FindInMap to customize environment variables based on keys</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>Goal: we want to form a aws resources string from environment map based on different conditions.<br></li>
<li><p>
Example:<br>
</p>
<div class="org-src-container">
<pre class="src src-yaml"><span class="org-variable-name">AWSTemplateFormatVersion</span>: <span class="org-string">'2010-09-09'</span>
<span class="org-variable-name">Description</span>: Resources supporting the App Service

<span class="org-variable-name">Mappings</span>:
  <span class="org-variable-name">TableMap</span>:
    <span class="org-variable-name">ReplicateTables</span>:
      <span class="org-variable-name">RoleMaster</span>: <span class="org-string">'app-role-master'</span>
      <span class="org-variable-name">ApiKeyTable</span>: <span class="org-string">'app-dummy-service-apikey'</span>
      <span class="org-variable-name">UserRoleTable</span>: <span class="org-string">'app-dummy-service-user-role'</span>
  <span class="org-variable-name">EnvironmentMap</span>:
    <span class="org-variable-name">ConfigEnvironment</span>:
      <span class="org-variable-name">DRSrcEnv</span>: <span class="org-string">'drdev'</span>


<span class="org-variable-name">Resource</span>:
  - <span class="org-type">!Sub</span> <span class="org-string">'arn:aws:dynamodb:*:*:table/app-*-${StackEnvironment}/index/*'</span>
  - <span class="org-variable-name">Fn::Sub</span>:
    - <span class="org-string">'arn:aws:dynamodb:*:*:table/${table}-${srcenv}'</span>
    - <span class="org-variable-name">table</span>:
<span class="org-yaml-tab">        </span><span class="org-variable-name">Fn::FindInMap</span>:
<span class="org-yaml-tab">        </span>  - TableMap
<span class="org-yaml-tab">        </span>  - <span class="org-type">!Ref</span> <span class="org-string">'ReplicateTables'</span>
<span class="org-yaml-tab">        </span>  - RoleMaster
  - <span class="org-variable-name">Fn::Sub</span>:
    - <span class="org-string">'arn:aws:dynamodb:*:*:table/${table}-${srcenv}/index/*'</span>
    - <span class="org-variable-name">table</span>:
<span class="org-yaml-tab">        </span><span class="org-variable-name">Fn::FindInMap</span>:
<span class="org-yaml-tab">        </span>  - TableMap
<span class="org-yaml-tab">        </span>  - <span class="org-type">!Ref</span> <span class="org-string">'ReplicateTables'</span>
<span class="org-yaml-tab">        </span>  - RoleMaster
      <span class="org-variable-name">srcenv</span>:
<span class="org-yaml-tab">        </span><span class="org-variable-name">Fn::FindInMap</span>:
<span class="org-yaml-tab">        </span>  - EnvironmentMap
<span class="org-yaml-tab">        </span>  - <span class="org-type">!Ref</span> <span class="org-string">'ConfigEnvironment'</span>
<span class="org-yaml-tab">        </span>  - DRSrcEnv      
</pre>
</div>
<ul class="org-ul">
<li>See <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-sub.html">Fn::Sub</a> for syntax rule. In general, the values is subtituded from two variable <code>table</code> and <code>srcenv</code> and each of them is referenced by the environment map defined by <code>Mappings</code>.<br></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="outline-container-org773ed9e" class="outline-2">
<h2 id="org773ed9e"><span class="section-number-2">8</span> My notes</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgf7c2d84" class="outline-3">
<h3 id="orgf7c2d84"><span class="section-number-3">8.1</span> Network Fundamentals</h3>
</div>
</section>
</main>
<footer id="postamble" class="status">
<div class='footer'>
  Copyright Â© 2020 <a href='mailto:hyperion_z@outlook.com'>Zhao Wei.</a><br>
  Inspired by <a href='https://nicolas.petton.fr'>https://nicolas.petton.fr</a> <br>
  Last updated on May 10, 2021. Generated using <a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.0.91 (<a href="https://orgmode.org">Org</a> mode 9.4.5).
</div>
</footer>
</body>
</html>
