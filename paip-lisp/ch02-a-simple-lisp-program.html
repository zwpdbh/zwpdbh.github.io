<!DOCTYPE html>
<html lang="en">
<head>
<!-- Feb 22, 2021 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>&lrm;</title>
<meta name="generator" content="Org mode">
<meta name="author" content="DESKTOP-TTOPQ58">
<link rel='icon' type='image/x-icon' href='/images/favicon.ico'/>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<link rel='stylesheet' href='https://code.cdn.mozilla.net/fonts/fira.css'>
<link rel='stylesheet' href='/css/site.css?v=2' type='text/css'/>
<link rel='stylesheet' href='/css/custom.css' type='text/css'/>
<link rel='stylesheet' href='/css/syntax-coloring.css' type='text/css'/>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../"> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><header id="top" class="status">
<div class='intro'>
  <img src='/images/Lisplogo_alien_256.png' alt='Land of Lisp' class='no-border'/>
  <h1>
    <span class="gray">Zhao</span>
    <span class="black">Wei</span>
  </h1>
  <p>How can man die better than facing fearful odds, for the ashes of his fathers and the temples of his Gods? -- By Horatius.</p>
</div>

<div class='nav'>
  <ul>
    <li><a href='/'>Blog</a>.</li>
    <li><a href='/about/'>About</a>.</li>
  </ul>
</div>
</header>
<main id="content">
<nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf284913">Description</a>
<ul>
<li><a href="#org0e729e7">Derivation of a single sentence using a context-free grammar</a></li>
<li><a href="#orgd3a529b">Traditional straightforward development</a></li>
<li><a href="#orgede7f43">Data driven development (rule-based solution)</a></li>
<li><a href="#orgc55cac0">Things we used</a></li>
</ul>
</li>
<li><a href="#orga6bb554">Exercise</a></li>
</ul>
</div>
</nav>
<section id="outline-container-orgf284913" class="outline-2">
<h2 id="orgf284913">Description</h2>
<div class="outline-text-2" id="text-orgf284913">
<p>
This chapter aims to practise the skill of combining basic functions and special forms of list into a complete program.
</p>
</div>

<div id="outline-container-org0e729e7" class="outline-3">
<h3 id="org0e729e7">Derivation of a single sentence using a context-free grammar</h3>
<div class="outline-text-3" id="text-org0e729e7">
<p>
Given the following rule, we want to generate a sentence based on that phrase-structure grammar.
</p>
<pre class="example" id="orge369e3f">
Sentence =&gt; Noun-Phrase + Verb-Phrase
Noun-Phrase =&gt; Article + Noun
Verb-Phrase =&gt; Verb + Noun-Phrase
Article =&gt; the, a,...
Noun =&gt; man, ball, woman, table...
Verb =&gt; hit, took, saw, liked...
</pre>
</div>
</div>
<div id="outline-container-orgd3a529b" class="outline-3">
<h3 id="orgd3a529b">Traditional straightforward development</h3>
<div class="outline-text-3" id="text-orgd3a529b">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">sentence</span> ()    (append (noun-phrase) (verb-phrase)))
(<span class="org-keyword">defun</span> <span class="org-function-name">noun-phrase</span> () (append (Article) (Noun)))
(<span class="org-keyword">defun</span> <span class="org-function-name">verb-phrase</span> () (append (Verb) (noun-phrase)))
(<span class="org-keyword">defun</span> <span class="org-function-name">Article</span> ()     (one-of '(<span class="org-keyword">the</span> a)))
(<span class="org-keyword">defun</span> <span class="org-function-name">Noun</span> ()        (one-of '(man ball woman table)))
(<span class="org-keyword">defun</span> <span class="org-function-name">Verb</span> ()        (one-of '(hit took saw liked)))
</pre>
</div>
<p>
In this approach, we create functions accordingto the grammar rules.
In traditional solution, the rules are expressed based on many lisp conventions, such as: case, if, and their order in the evaluation (we use functions&rsquo;s call to express those rules.).
</p>
</div>
</div>
<div id="outline-container-orgede7f43" class="outline-3">
<h3 id="orgede7f43">Data driven development (rule-based solution)</h3>
<div class="outline-text-3" id="text-orgede7f43">
<ol class="org-ol">
<li>Concentrate on how to make it easy to <b>express rule directly using lisp</b>.</li>
<li>Worry later about how they will be processed.</li>
</ol>

<p>
Consider the rules
</p>
<pre class="example" id="org9e3cb1a">
Sentence =&gt; Noun-Phrase + Verb-Phrase
Noun-Phrase =&gt; Article + Noun
Verb-Phrase =&gt; Verb + Noun-Phrase
Article =&gt; the, a, ...
Noun =&gt; man, ball, woman, table...
Verb =&gt; hit, took, saw, liked...
</pre>

<p>
We use the following lisp code represent their rules:
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defparameter</span> <span class="org-variable-name">*simple-grammar*</span>
  '((sentence -&gt; (noun-phrase verb-phrase))
    (noun-phrase -&gt; (Article Noun))
    (verb-phrase -&gt; (Verb noun-phrase))
    (Article -&gt; the a)
    (Noun -&gt; man ball woman table)
    (Verb -&gt; hit took saw liked))
  <span class="org-doc">"A grammar for a trivial subset of English."</span>)

(<span class="org-keyword">defvar</span> <span class="org-variable-name">*grammar*</span> *simple-grammar*
  <span class="org-doc">"The grammar used by generate.  Initially, this is</span>
<span class="org-doc">  *simple-grammar*, but we can switch to other grammars."</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">rule-lhs</span> (rule)
  <span class="org-doc">"The left hand side of a rule."</span>
  (first rule))

(<span class="org-keyword">defun</span> <span class="org-function-name">rule-rhs</span> (rule)
  <span class="org-doc">"The right hand side of a rule."</span>
  (rest (rest rule)))

(<span class="org-keyword">defun</span> <span class="org-function-name">rewrites</span> (category)
  <span class="org-doc">"Return a list of the possible rewrites for this category."</span>
  (rule-rhs (assoc category *grammar*)))

(<span class="org-keyword">defun</span> <span class="org-function-name">generate</span> (phrase)
  <span class="org-doc">"Generate a random sentence or phrase"</span>
  (<span class="org-keyword">cond</span> ((listp phrase)
         (mappend #'generate phrase))
        ((rewrites phrase)
         (generate (random-elt (rewrites phrase))))
        (t (list phrase)))) 

(<span class="org-keyword">defun</span> <span class="org-function-name">mappend</span> (fn lst)
  (apply #'append (mapcar fn lst)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc55cac0" class="outline-3">
<h3 id="orgc55cac0">Things we used</h3>
<div class="outline-text-3" id="text-orgc55cac0">
<ul class="org-ul">
<li>append</li>
<li><p>
elt
</p>
<div class="org-src-container">
<pre class="src src-lisp">(elt '(1 2 3 4 5) 2)
</pre>
</div></li>
<li><p>
random, we use it to implement one-of and random-element
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">one-of</span> (lst)
  (list (random-element lst)))

(<span class="org-keyword">defun</span> <span class="org-function-name">random-element</span> (lst)
  (elt lst (random (length lst))))
</pre>
</div></li>
<li><p>
assoc
</p>
<div class="org-src-container">
<pre class="src src-lisp">(assoc '1 '((1 -&gt; first) (2 -&gt; second) (3 -&gt; third)))
</pre>
</div></li>

<li>By convention, <code>defvar</code> is used to define var and <code>defparameter</code> is used to define constant. They are all used to define <b>global variable</b>.</li>

<li>To define <b>local variable</b>, use <code>let</code>.</li>

<li><b>By comparing traditional and data-driven development</b>
<ul class="org-ul">
<li>The traditional approach construct different functions and compose them to express the rule directly. It becomes hard to maintain once the rule become complex. Because we are doing straightforward mapping of the problem description into lisp code.</li>
<li>The rule bsed approach (data-driven) on the other hand: 
<ul class="org-ul">
<li>First, focus on how to express rules as natual as possible with lisp code.</li>
<li>Then, define a layer of tools to help to operate on those rules.
<b>In this step, we are actually writing a simple interpreter for notation introduced from first step.</b></li>
<li>Finally, with those tools, we define our final function according to the rules. (These rules are not the primitive rules; they are the rules expressed in lisp code from first step.)</li>
</ul></li>
<li>The idea behind second approach is to work with the problem as much as possible in its own terms, and to minimize the part of the solution that is written directly in Lisp.</li>
<li>The extra advantages of representing information in declarative form (rules or facts) rather than lisp function is that it can be easier to use the information for multiple purpose. This is called <b>one-data/multiple-program</b>.</li>
</ul></li>
</ul>
</div>
</div>
</section>

<section id="outline-container-orga6bb554" class="outline-2">
<h2 id="orga6bb554">Exercise</h2>
</section>
</main>
<footer id="postamble" class="status">
<div class='footer'>
  Copyright Â© 2020 <a href='mailto:hyperion_z@outlook.com'>Zhao Wei.</a><br>
  Inspired by <a href='https://nicolas.petton.fr'>https://nicolas.petton.fr</a> <br>
  Last updated on Feb 22, 2021. Generated using <a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.0.91 (<a href="https://orgmode.org">Org</a> mode 9.4.4).
</div>
</footer>
</body>
</html>
